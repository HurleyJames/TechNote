## 机器学习性能评估指标

### 引言

**机器学习**分为**三个阶段**：

* 第一阶段：**学习模型**。利用学习算法，通过对训练集进行归纳学习得到分类模型；
* 第二阶段：**测试模型**。将已经学习得到的分类模型用于测试集，对测试集中未知类别的实例进行分类；
* 第三阶段：**性能评估**。通过测试集产生的分类未必是最佳的，导致对测试集的分类可能产生错误。通过对分类器性能评价至关重要。

业内目前常常使用的评价指标有**精确率（Precision**）、**召回率（Recall）**、**F值（F-Measure）**等。

![](https://raw.githubusercontent.com/HurleyJames/ImageHosting/master/machine_learning_performance_evaluation.png)

### 分类器评估标准

#### 混淆矩阵

目前，分类器性能评价标准有很多，比较常用的有准确率、错误率、查全率、查准率和F1等。

##### 定义

**混淆矩阵**（Confusion Matrix）就是用于总结有指导分类结果的矩阵。<u>沿着主对角线上的项表示正确分类的总数，其它非对角线的项表示分类的错误数。</u>

##### 二分类的混淆矩阵

![](https://raw.githubusercontent.com/HurleyJames/ImageHosting/master/IMG_0042.jpg)

* 真阳性True Positive(真正, TP)：被判定为正样本，实际上是正样本
* 真阴性True Negative(真负 , TN)：被判定为负样本，实际上是负样本
* 假阳性False Positive(假正, FP)：被判定为正样本，实际上是负样本
* =假阴性False Negative(假负 , FN)：被判定为负样本，实际上是正样本

> 实际正例数```(P)=TP+FN```，实际负例数```(N)=FP+TN```，实例总数```(C)=P+N```

##### 准确率(accuracy)

* 定义：**正确分类**的测试实例个数占测试**实例总数**的比例，用于衡量模型正确的预测新的或先前未见过的数据的类标号的能力。
* 计算公式：```Accuracy=(TP+TN)/(TP+TN+FP+FN)```

> 在**正负样本不平衡**的情况下，准确率这个评价指标有很大的缺陷。

> **影响分类器准确率**的的因素有：训练数据集记录的数目、属性的数目、属性中的信息、测试数据集记录的分布情况等。

##### 错误率

* 定义：**错误分类**的测试实例个数占测试**实例总数**的比例，表示分类器做出错误分类的概率有多大。
* 计算公式：```ErrorRate=1-Accuracy=(FN+FP)/(TP+TN+FP+FN)```

##### 精确率(precision)

* 定义：正确分类的正例个数占分类判定为正例的实例个数的比例，也叫**查准率**。
* 计算公式：```TP/(TP+FP)```

##### 召回率(recall)

* 定义：正确分类的正例个数占实际正例个数的比例，也称**查全率**。
* 计算公式：```TP/(TP+FN)```

##### (Sensitivity)

* 定义：
* 计算公式：```TP/(TP+FN)```

##### (Specificity)

* 定义：
* 计算公式：```TN/(TN+FP)```

##### F-值(F-Measure)

* 定义：F-Measure是查全率与查准率**加权调和平均**，又称**F-Score**
* 计算公式：$F1=2PR/(P+R)=2TP/(2TP+FP+FN)$

> 在精确率和准确率都高的情况下，F1值也会较高。

##### MCC马修斯相关系数(Matthews Correlation Coefficient)

马修斯相关系数是在使用机器学习作为二进制的质量的度量的分类，用以测量二分类的分类性能的指标。该指标考虑到了真阳性、真阴性、假阳性和假阴性，通常认为该指标是一个比较均衡的指标。即使在两种类别的样本含量**差别很大**时，也可以应用它。

MCC本质上是一个描述实际分类与预测分类之间的相关系数，它的取值范围为[-1,1]，取值为1时表示对受试对象的完美预测，取值为0时表示预测的结果还不如随机预测的结果，-1是指预测分类和实际分类完全不一致。可以使用以下公式直接从混淆矩阵计算MCC：

![](https://raw.githubusercontent.com/HurleyJames/ImageHosting/master/MCC.png)

> MCC用来衡量不平衡数据集的指标比较好。